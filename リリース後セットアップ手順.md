# リリース後セットアップ手順

## 📋 リリース完了後の推奨作業

一般リリースが完了しました。以下を実施することを推奨します。

## 1. ✅ RLSポリシーを本番環境用に更新（推奨）

補完的なセキュリティ層として、本番環境用のRLSポリシーを適用することを推奨します。

### ステップ1: Supabaseダッシュボードにアクセス

1. **Supabaseダッシュボードを開く**
   - https://supabase.com/dashboard/project/hgcmbmcjzdfugbnljkel

2. **SQL Editorを開く**
   - 左サイドバーから「SQL Editor」をクリック

### ステップ2: 本番環境用RLSポリシーを実行

1. **新しいクエリを作成**
   - 「New query」をクリック

2. **`supabase/point-card-schema-production.sql` の内容をコピー**
   - ファイルの内容をすべてコピー

3. **SQL Editorに貼り付け**
   - コピーした内容をSQL Editorに貼り付け

4. **実行**
   - 「Run」ボタンをクリック
   - または `Ctrl+Enter` (Windows/Linux) / `Cmd+Enter` (Mac)

5. **確認**
   - エラーが表示されなければ成功
   - すべてのポリシーが更新されます

### 注意事項

- サービスロールキーはRLSをバイパスするため、これらのポリシーは補完的な役割のみ
- 実際のセキュリティはアプリケーションレベル（JWT認証）で確保されています
- この作業は必須ではありませんが、セキュリティの層を追加するために推奨されます

## 2. ✅ 動作確認（推奨）

デプロイされたアプリケーションで、すべての機能が正常に動作するか確認してください。

### 顧客機能の確認

#### 1. 顧客登録
1. **デプロイURLにアクセス**
   - https://cmsbeppin.vercel.app

2. **顧客登録ページにアクセス**
   - https://cmsbeppin.vercel.app/register

3. **新規顧客を登録**
   - 電話番号（例: `090-1234-5678`）
   - パスワード（例: `password123`）
   - 名前（任意）
   - メールアドレス（任意）

4. **確認**
   - ✅ 登録が成功する
   - ✅ ログインページにリダイレクトされる

#### 2. 顧客ログイン
1. **ログインページにアクセス**
   - https://cmsbeppin.vercel.app/login

2. **ログイン**
   - 登録した電話番号とパスワードを入力

3. **確認**
   - ✅ ログインが成功する
   - ✅ 顧客ダッシュボードにリダイレクトされる

#### 3. 顧客ダッシュボード
1. **ダッシュボードを確認**
   - https://cmsbeppin.vercel.app/dashboard

2. **確認**
   - ✅ ダッシュボードが表示される
   - ✅ ポイント情報が表示される（初期値: 0ポイント）
   - ✅ 来店履歴が表示される（空でもOK）

### 管理者機能の確認

#### 1. 管理者登録
1. **管理者登録ページにアクセス**
   - https://cmsbeppin.vercel.app/admin/register

2. **初期管理者アカウントを作成**
   - 名前（例: `管理者`）
   - メールアドレス（例: `admin@example.com`）
   - パスワード（例: `admin123456`）

3. **確認**
   - ✅ 登録が成功する
   - ✅ 管理者ログインページにリダイレクトされる

#### 2. 管理者ログイン
1. **管理者ログインページにアクセス**
   - https://cmsbeppin.vercel.app/admin/login

2. **ログイン**
   - 登録したメールアドレスとパスワードを入力

3. **確認**
   - ✅ ログインが成功する
   - ✅ 管理者ダッシュボードにリダイレクトされる

#### 3. 管理者ダッシュボード
1. **ダッシュボードを確認**
   - https://cmsbeppin.vercel.app/admin/dashboard

2. **確認**
   - ✅ ダッシュボードが表示される
   - ✅ 統計情報が表示される

#### 4. 来店履歴管理
1. **来店履歴ページにアクセス**
   - https://cmsbeppin.vercel.app/admin/visits

2. **確認**
   - ✅ 来店履歴ページが表示される
   - ✅ 新規来店履歴を追加できる（テスト推奨）

#### 5. キャスト管理
1. **キャスト管理ページにアクセス**
   - https://cmsbeppin.vercel.app/admin/casts

2. **確認**
   - ✅ キャスト管理ページが表示される
   - ✅ 新規キャストを追加できる（テスト推奨）

#### 6. アラート管理
1. **アラート管理ページにアクセス**
   - https://cmsbeppin.vercel.app/admin/alerts

2. **確認**
   - ✅ アラート管理ページが表示される
   - ✅ アラートが表示される（初期状態では空でもOK）

#### 7. 設定管理
1. **設定管理ページにアクセス**
   - https://cmsbeppin.vercel.app/admin/settings

2. **確認**
   - ✅ 設定管理ページが表示される
   - ✅ 設定項目が表示される
   - ✅ 設定を変更できる（テスト推奨）

## 3. ✅ 初期管理者アカウントの作成（推奨）

本番環境で管理者アカウントを作成することを強く推奨します。

### 手順

1. **デプロイURLにアクセス**
   - https://cmsbeppin.vercel.app

2. **管理者登録ページにアクセス**
   - https://cmsbeppin.vercel.app/admin/register

3. **初期管理者アカウントを作成**
   - 名前: 管理者の名前を入力
   - メールアドレス: 管理者のメールアドレスを入力（重要: 本番環境で使用するメールアドレス）
   - パスワード: 強力なパスワードを設定（推奨: 12文字以上、大文字・小文字・数字・記号を含む）

4. **確認**
   - ✅ 登録が成功することを確認
   - ✅ ログインできることを確認

### セキュリティのベストプラクティス

- **強力なパスワードを使用**
  - 12文字以上
  - 大文字・小文字・数字・記号を含む
  - 例: `Admin@2024!Secure`

- **パスワードを安全に保管**
  - パスワードマネージャーを使用
  - 紙に書いて安全な場所に保管

- **2要素認証の検討**（将来的な機能拡張）
  - より高いセキュリティを求める場合は、2要素認証の導入を検討

## 4. ✅ エラーログの確認（推奨）

定期的にエラーログを確認することを推奨します。

### Vercelのログを確認

1. **Vercelダッシュボードにアクセス**
   - https://vercel.com/dashboard

2. **プロジェクトを選択**
   - `cmsbeppin` プロジェクトを選択

3. **ログを確認**
   - 「Logs」タブをクリック
   - エラーが発生していないか確認

### Supabaseのログを確認

1. **Supabaseダッシュボードにアクセス**
   - https://supabase.com/dashboard/project/hgcmbmcjzdfugbnljkel

2. **ログを確認**
   - 「Logs」→「API Logs」をクリック
   - エラーが発生していないか確認

## 5. ✅ パフォーマンスの確認（推奨）

アプリケーションのパフォーマンスを確認することを推奨します。

### ページの読み込み速度

1. **Google PageSpeed Insightsを使用**
   - https://pagespeed.web.dev/
   - デプロイURLを入力: `https://cmsbeppin.vercel.app`
   - スコアを確認

2. **改善が必要な場合**
   - 画像の最適化
   - コードの最適化
   - CDNの使用（Vercelは自動で提供）

### データベースのパフォーマンス

1. **Supabaseダッシュボードで確認**
   - 「Database」→「Performance」をクリック
   - クエリの実行時間を確認

## 6. ✅ バックアップ設定（推奨）

Supabaseでバックアップを有効にすることを推奨します。

### 手順

1. **Supabaseダッシュボードにアクセス**
   - https://supabase.com/dashboard/project/hgcmbmcjzdfugbnljkel

2. **Settings → Database → Backupsを確認**
   - バックアップが有効になっているか確認
   - SupabaseのFreeプランでは、自動バックアップが提供されます

3. **手動バックアップの作成**（必要に応じて）
   - 「Database」→「Backups」をクリック
   - 手動でバックアップを作成可能

## 📋 チェックリスト

### 完了した項目

- [ ] ✅ RLSポリシーを本番環境用に更新
- [ ] ✅ 顧客登録が動作することを確認
- [ ] ✅ 顧客ログインが動作することを確認
- [ ] ✅ 顧客ダッシュボードが表示されることを確認
- [ ] ✅ 管理者登録が動作することを確認
- [ ] ✅ 管理者ログインが動作することを確認
- [ ] ✅ 管理者ダッシュボードが表示されることを確認
- [ ] ✅ 来店履歴管理が動作することを確認
- [ ] ✅ キャスト管理が動作することを確認
- [ ] ✅ アラート管理が動作することを確認
- [ ] ✅ 設定管理が動作することを確認
- [ ] ✅ 初期管理者アカウントを作成
- [ ] ✅ エラーログを確認
- [ ] ✅ パフォーマンスを確認

## 🎉 完了

すべての確認が完了したら、アプリケーションは本番環境で使用可能です！

お疲れ様でした！

