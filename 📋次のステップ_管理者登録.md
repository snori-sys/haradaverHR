# 📋 次のステップ：管理者登録の準備

## 🎯 優先順位順の手順

### 1️⃣ 【最重要】データベーススキーマの確認・実行

**まず、本番環境のSupabaseでデータベーススキーマが実行されているか確認しましょう。**

#### ステップ1: Supabaseダッシュボードにアクセス

1. **Supabaseダッシュボードを開く**
   - https://supabase.com/dashboard/project/hgcmbmcjzdfugbnljkel

2. **Table Editorを開く**
   - 左サイドバーから「Table Editor」をクリック

3. **admin_usersテーブルが存在するか確認**
   - テーブル一覧に以下のテーブルが表示されるか確認：
     - ✅ `admin_users` （管理者テーブル）
     - ✅ `customers` （顧客テーブル）
     - ✅ `visits` （来店履歴テーブル）
     - ✅ `casts` （キャストテーブル）
     - ✅ `point_transactions` （ポイント取引履歴テーブル）
     - ✅ `settings` （設定テーブル）
     - ✅ `alerts` （アラートテーブル）

#### ステップ2: テーブルが存在しない場合

**もし `admin_users` テーブルが存在しない場合、データベーススキーマを実行する必要があります。**

1. **SQL Editorを開く**
   - 左サイドバーから「SQL Editor」をクリック

2. **新しいクエリを作成**
   - 「New query」をクリック

3. **データベーススキーマを実行**
   - ファイル `supabase/point-card-schema.sql` の内容をすべてコピー
   - SQL Editorに貼り付け
   - 「Run」ボタンをクリック（または `Ctrl+Enter` / `Cmd+Enter`）

4. **確認**
   - エラーが表示されなければ成功
   - Table Editorで `admin_users` テーブルが表示されることを確認

### 2️⃣ デプロイ完了を待つ

1. **Vercelダッシュボードを確認**
   - https://vercel.com/dashboard
   - `cmsbeppin` プロジェクトを選択
   - デプロイが完了するまで待つ（通常2-5分）

2. **デプロイ完了の確認**
   - デプロイステータスが「Ready」になったら完了

### 3️⃣ 管理者登録を試す

デプロイが完了したら、管理者登録を試してください。

#### ステップ1: 登録ページにアクセス

1. **登録ページを開く**
   - https://cmsbeppin.vercel.app/admin/register
   - または https://cmsbeppin.vercel.app/admin/login から「アカウントをお持ちでない方は登録」をクリック

#### ステップ2: 情報を入力

1. **名前**（例: `管理者`）
2. **メールアドレス**（例: `admin@example.com`）
   - 本番環境で使用するメールアドレスを入力
3. **パスワード**（例: `Admin@2024!Secure`）
   - 8文字以上
   - 推奨: 12文字以上、大文字・小文字・数字・記号を含む

#### ステップ3: 登録を実行

1. **「登録」ボタンをクリック**
2. **成功した場合**
   - 「登録完了」メッセージが表示される
   - 自動的にログインページにリダイレクトされる
3. **エラーが表示された場合**
   - ブラウザのコンソール（F12）でエラー詳細を確認
   - Vercelのログでエラー詳細を確認

### 4️⃣ エラーが発生した場合のトラブルシューティング

#### エラー: 「管理者登録に失敗しました」

**原因の可能性：**
1. データベーススキーマが実行されていない
   - → ステップ1を実行してください
2. 環境変数が設定されていない
   - → Vercelで環境変数を確認してください
3. RLSポリシーが正しく設定されていない
   - → データベーススキーマを実行してください

**確認方法：**
1. **ブラウザのコンソールを確認**（F12）
   - エラーログの詳細を確認
2. **Vercelのログを確認**
   - https://vercel.com/dashboard
   - 「Logs」タブでエラー詳細を確認

詳細は `管理者登録エラー解決ガイド.md` を参照してください。

## ✅ チェックリスト

準備ができたら、以下を確認してください：

- [ ] ✅ データベーススキーマが実行されている（admin_usersテーブルが存在する）
- [ ] ✅ Vercelのデプロイが完了している
- [ ] ✅ 環境変数が設定されている（Vercel）
- [ ] ✅ 管理者登録ページにアクセスできる
- [ ] ✅ 登録が成功する
- [ ] ✅ 管理者ログインが動作する

## 🎉 登録が成功したら

管理者登録が成功したら、以下を確認してください：

1. **管理者ログインが動作するか**
   - https://cmsbeppin.vercel.app/admin/login
   - 登録したメールアドレスとパスワードでログイン

2. **管理者ダッシュボードが表示されるか**
   - ログイン後、ダッシュボードが表示されることを確認

3. **各種機能が動作するか**
   - 来店履歴管理
   - キャスト管理
   - アラート管理
   - 設定管理

## 📝 まとめ

**今すぐやること：**

1. **データベーススキーマの確認**（最重要）
   - Supabaseダッシュボードで `admin_users` テーブルが存在するか確認
   - 存在しない場合は、`supabase/point-card-schema.sql` を実行

2. **デプロイ完了を待つ**
   - Vercelのダッシュボードで確認

3. **管理者登録を試す**
   - https://cmsbeppin.vercel.app/admin/register

お疲れ様です！まずはデータベーススキーマの確認から始めましょう！

